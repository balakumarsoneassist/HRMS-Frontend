<p-toast></p-toast>

<div class="card p-4">
  <h2 class="mb-4 text-xl font-bold">Payment List</h2>

  <p-table
    [value]="paymentList"
    [paginator]="true"
    [rows]="10"
    [loading]="loading"
    [rowsPerPageOptions]="[10,20,50]"
    responsiveLayout="scroll"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Track Number</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Mobile Number</th>
        <th>Status</th>
        <th>Sanction Amount</th>
        <th>Payout %</th>
        <th>Payout Amount</th>
        <th>Connector</th>
        <th>Action</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-p>
      <tr>
        <td>{{ p.TrackNumber }}</td>
        <td>{{ p.FirstName }}</td>
        <td>{{ p.LastName }}</td>
        <td>{{ p.MobileNumber }}</td>
        <td>
          <span
            class="badge"
            [ngClass]="{
              'bg-green-100 text-green-800': p.Status === 'completed',
              'bg-red-100 text-red-800': p.Status !== 'completed'
            }"
          >
            {{ p.Status }}
          </span>
        </td>
        <td>{{ p.SanctionValue | number: '1.0-2' }}</td>
        <td>{{ p.PayoutPercent }}%</td>
        <td>{{ (p.PayoutPercent / 100) * p.SanctionValue | number: '1.2' }}</td>
        <td>{{ p.ConnectorName }}</td>
        <td>
          <ng-container *ngIf="!p.IsPaid; else paidBlock">
            <button
              pButton
              icon="pi pi-money-bill"
              label="Pay"
              class="p-button-success p-button-sm"
              [disabled]="p.Status !== 'completed'"
              (click)="updateConnectorPayment(p.Id)"
            ></button>
          </ng-container>
          <ng-template #paidBlock>
            <span class="text-green-600 font-semibold">Paid</span>
          </ng-template>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
