<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<div class="card p-4">
  <h2 class="mb-4 text-2xl font-bold">Assigned Contacts</h2>

  <form [formGroup]="filterForm" (ngSubmit)="getAssignedReport()" class="p-fluid">
    <div class="formgrid grid">
      <!-- Assignee -->
      <div class="field col-12 md:col-4">
        <p-dropdown
          [options]="EmpList"
          formControlName="AssigneeName"
          placeholder="Select Assignee"
          [showClear]="true"
        ></p-dropdown>
      </div>

      <!-- Status -->
      <div class="field col-12 md:col-4">
        <p-dropdown
          [options]="StatusList"
          formControlName="Status"
          placeholder="Select Status"
          [showClear]="true"
        ></p-dropdown>
      </div>

      <div class="field col-12 md:col-4 flex align-items-end">
  <p-button
    label="Report"
    icon="pi pi-file"
    class="p-button-success font-w-600 border-0"
    [style]="{ height: '40px', borderRadius: '0' }"

    type="submit"
  ></p-button>
</div>

    </div>
  </form>

  <div class="my-3">
    <input
      pInputText
      type="text"
      placeholder="Search contacts"
      [(ngModel)]="ContactListFilter"
      (input)="onSearchChange()"
      class="w-full"
    />
  </div>

  <p-table
    [value]="ContactList"
    [paginator]="true"
    [rows]="10"
    [totalRecords]="TotalRecordNo"
    [lazy]="true"
    (onLazyLoad)="onLazyLoad($event)"
    [loading]="loading"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Name</th>
        <th>Mobile</th>
        <th>Location</th>
        <th>Status</th>
        <th>Assignee</th>
        <th>Appointment Date</th>
        <th>Track ID</th>
        <th>Notes</th>
        <th>Created Date</th>
        <th>Remarks</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-contact>
      <tr>
        <td>{{ contact.Name }}</td>
        <td>{{ contact.MobileNumber }}</td>
        <td>{{ contact.Location }}</td>
        <td>
       <span
  class="text-yellow-500  d-inline-flex justify-content-center align-items-center font-bold"
  style="width: 80px; height: 30px; font-size: 1rem;"
>
  {{ contact.Status | lowercase }}
</span>
        </td>
        <td>{{ contact.AssigneeName }}</td>
        <td>{{ contact.AppointmentDate | date: 'dd-MM-yyyy HH:mm' }}</td>
        <td>{{ contact.TrackNumber }}</td>
        <td>{{ contact.Notes }}</td>
        <td>{{ contact.createddt }}</td>
        <td>{{ contact.remarks }}</td>
        <td class="flex flex-row gap-2">
  <p-button
    icon="pi pi-user-plus"
    severity="success"
    rounded
    text
    [disabled]="contact.Status !== 'unassigned'"
    (onClick)="AssignEmployee(contact.Id, contact.IsConnectorContact)"
    pTooltip="Assign to me"
    tooltipPosition="top"
  ></p-button>

  <p-button
    icon="pi pi-pencil"
    severity="warn"
    rounded
    text
    [disabled]="
      contact.Status === 'unassigned' ||
      contact.Status === 'reject' ||
      contact.IsUpdate === 0
    "
    (onClick)="callStatus(contact.TrackNumber, contact.Id)"
    pTooltip="Update status"
    tooltipPosition="top"
  ></p-button>

  <p-button
    icon="pi pi-eye"
    severity="info"
    rounded
    text
    [disabled]="contact.Status !== 'reject'"
    (onClick)="OpenTrackHistoryModel(contact.TrackNumber)"
    pTooltip="View history"
    tooltipPosition="top"
  ></p-button>

  <p-button
    icon="pi pi-trash"
    severity="danger"
    rounded
    text
    (onClick)="deleteRow(contact.Id)"
    pTooltip="Delete"
    tooltipPosition="top"
  ></p-button>
</td>


      </tr>
    </ng-template>
  </p-table>
</div>
<p-dialog
  header="Update Lead"
  [(visible)]="displayLeadForm"
  [modal]="true"
  [closable]="true"
  [style]="{ width: '50vw', minWidth: '300px' }"
  (onHide)="onLeadFormClose()"
>
  <!-- if your child component has @Input()s for ID/Track, pass them: -->
    <ng-container *ngIf="displayLeadForm">
    <app-lead-form-model
    ></app-lead-form-model>
  </ng-container>
</p-dialog>
<!-- <div class="myModel callHistoryModel  position-fixed model-bg-color justify-content-center align-items-center w-100 h-100 model-bg-color z-index-3 overflow-auto">
    <div class="modelContent bg-color-white boxShadow rounded">
      <div class="d-flex flex-row justify-content-between flex-nowrap py-2 px-3 font-w-600 font-size-19 align-items-center border-b bg-color-ContHead rounded">
          <div></div>
          <div (click)="CloseTrackHistoryModel()">
              <i class="fas fa-times cursor-pointer"></i>
          </div>
      </div>
      <app-call-track-history></app-call-track-history>
    </div>
  </div>
<app-lead-form-model></app-lead-form-model> -->
<!-- model following status - end -->
