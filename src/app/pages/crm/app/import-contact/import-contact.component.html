<p-toast></p-toast>

<div class="card p-4">
  <h2 class="mb-4 text-2xl font-bold">Import Contact</h2>

  <!-- File Upload -->
  <p-fileUpload
    name="file"
    url="{{ importUrl }}"
    mode="basic"
    accept=".csv"
    chooseLabel="Choose File"
    uploadLabel="Upload"
    cancelLabel="Clear"
    [auto]="false"
    [customUpload]="true"
    (uploadHandler)="onUpload($event)"
    class="w-full mb-4"
  ></p-fileUpload>

  <p-button
    label="Download Template"
    icon="pi pi-download"
    class="p-button-info mb-4"
    (onClick)="downloadTemplate()"
  ></p-button>

  <!-- Imported Files Table -->
  <p-table
    [value]="excelList"
    [paginator]="true"
    [rows]="10"
    responsiveLayout="scroll"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>File Name</th>
        <th>Uploaded Time</th>
        <th>Status</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-e>
      <tr>
        <td>{{ e.FileName }}</td>
        <td>{{ e.UploadedTime | date:'dd-MM-yyyy HH:mm' }}</td>
        <td>{{ e.IsUpdate ? 'Updated' : 'Imported' }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>
